(function(){var t,n,e,r,i,o,s,a,u,l,p;o="1.0",p=this,p.jetbrick=s={version:o,global:p},String.prototype.trim||(String.prototype.trim=function(){return _.string.trim(this)}),String.prototype.clean=function(){return _.string.clean(this)},String.prototype.truncate=function(t){return _.string.truncate(this,t)},String.prototype.startsWith=function(t){return _.string.startsWith(this,t)},String.prototype.endsWith=function(t){return _.string.endsWith(this,t)},String.prototype.blank=function(){return _.string.isBlank(this)},String.prototype.before=function(t){return _.string.strLeft(this,t)},String.prototype.beforeLast=function(t){return _.string.strLeftBack(this,t)},String.prototype.after=function(t){return _.string.strRight(this,t)},String.prototype.afterLast=function(t){return _.string.strRightBack(this,t)},String.prototype.capitalize=function(){return _.string.capitalize(this)},String.prototype.swapCase=function(){return _.string.swapCase(this)},String.prototype.camelize=function(){return _.string.camelize(this)},String.prototype.classify=function(){return _.string.classify(this)},String.prototype.underscored=function(){return _.string.underscored(this)},String.prototype.dasherize=function(){return _.string.dasherize(this)},String.prototype.lpad=function(t,n){return _.string.lpad(this,t,n)},String.prototype.rpad=function(t,n){return _.string.rpad(this,t,n)},String.repeat=function(t,n){return _.string.repeat(this,t,n)},String.count=function(t){return _.string.count(this,t)},String.escapeHTML=function(){return _.string.escapeHTML(this)},String.unescapeHTML=function(){return _.string.unescapeHTML(this)},String.stripTags=function(t,n){return _.string.repeat(this,t,n)},String.prototype.between=function(t,n){var e,r;return null==n&&(n=t),r=this.indexOf(t),-1!==r&&(e=this.indexOf(n,r+t.length),-1!==e)?this.substring(r+t.length,e):null},String.prototype.bytesLength=function(){return this.replace(/[^\x00-\xff]/g,"00").length},s.uuid=function(t){var n,e,r;for(null==t&&(t=32),n=[],e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;t>r;)n[r]=e.charAt(Math.floor(Math.random()*e.length)),r++;return n.join("")},Date.prototype.toJSON=function(){var t;return t=function(t){return 10>t?"0"+t:t},this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+" "+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())},Date.prototype.readableDate=function(){var t,n,e,r;return n=this,r="",t=((new Date).getTime()-n.getTime())/1e3,60>t?r="刚刚":3600>t?r=Math.floor(t/60)+"分钟前":86400>t?r=Math.floor(t/3600)+"小时前":604800>t?(e=Math.floor(t/86400),r=2>e?"昨天":e+"天前"):r=n.toLocaleDateString(),r},Number.prototype.pad=function(t){return _.string.lpad(""+this,t,"0")},Number.prototype.format=function(t,n){var e;return null==t&&(t=2),null==n&&(n=!0),e=n?",":"",_.string.numberFormat(this,t,".",e)},s.isInNumberRange=function(t,n,e){return t>=n&&e>=t},Number.prototype.readableSize=function(t){var n;return null==t&&(t=2),n=Math.floor(this),1024>n?""+n+"Byte":1048576>n?(n/1024).format(t)+"KB":1073741824>n?(n/1024/1024).format(t)+"MB":1099511627776>n?(n/1024/1024/1024).format(t)+"GB":void 0},Number.prototype.readableTime=function(t){var n,e,r,i,o,s;return null==t&&(t=!1),s=this,n=Math.floor(s/36e5),e=Math.floor((s-36e5*n)/6e4),i=Math.floor((s-36e5*n-6e4*e)/1e3),o=n.pad(2)+":"+e.pad(2)+":"+i.pad(2),t&&(r=Math.floor(s%1e3),o+=","+r.pad(3)),o},Number.prototype.readableSeconds=function(t){var n,e,r,i,o,s;return null==t&&(t=0),s=this,e=Math.floor(s/864e5),r=Math.floor((s-864e5*e)/36e5),i=Math.floor((s-864e5*e-36e5*r)/6e4),o=(s-864e5*e-36e5*r-6e4*i)/1e3,n=[],e>0&&n.push(e,"天"),r>0&&n.push(r,"小时"),i>0&&n.push(i,"分"),n.push(o.format(t),"秒"),n.join("")},s.isNull=function(t){return null===t||void 0===t},s.isNotNull=function(t){return!s.isNull(t)},s.asString=function(t){return s.isNull(t)?null:""+t},s.asFloat=function(t,n){var e;return s.isNull(t)?null:_.isNumber(t)?t:(e=parseFloat(""+t,10),n&&(e=parseFloat(e.toFixed(n))),e)},s.asInt=function(t){var n;return s.isNull(t)?null:_.isNumber(t)?t.toFixed(0):(n=""+t,/^\s*-?0x/i.test(n)?parseInt(n,16):parseInt(n,10))},s.asBoolean=function(t){var n;return s.isNull(t)?!1:_.isBoolean(t)?t:_.isString(t)?(n=(""+t).toLowerCase(),"true"===n||"yes"===n||"on"===n||"t"===n||"y"===n||"1"===n):!!t},s.asDate=function(t){return s.isNull(t)?null:_.isDate(t)?t:_.isNumber(t)?new Date(t):Date.parseExact(""+t,s.asDate.DATE_FORMATER_LIST)},s.asDate.DATE_FORMATER_LIST=["yyyy-MM-dd HH:mm:ss","yyyy-MM-dd","HH:mm:ss"],s.asFunction=function(t,n){var e;return s.isNull(t)?null:_.isFunction(t)?t:n&&(e=s.get(n,t),_.isFunction(e))?e:(e=s.get(s.global,t),_.isFunction(e)?e:null)},s.asJSON=function(t){return s.isNull(t)?null:_.isString(t)?JSON.parse(t):t},s.substitute=function(t,n,e){var r;return r=/\{([^{}]+)\}/g,_.isFunction(e)||(e=function(t){return t}),t.replace(r,function(t,r){var i;return i=s.nestedValue(n,r),null==i&&(i=""),e(i)})},s.usTemplate=function(t,n){var e;return e={evaluate:/`([\s\S]+?)`/g,interpolate:/\{([\s\S]+?)\}/g,escape:/@\{([\s\S]+?)\}/g},_.template(t,n,e)},String.prototype.isNumeric=function(){return/^[0-9]+$/.test(this)},String.prototype.isAlpha=function(){return/^[a-zA-Z]+$/.test(this)},String.prototype.isAlphaNumeric=function(){return/^[a-zA-Z0-9]+$/.test(this)},String.prototype.isIPAddress=function(){var t,n,e,r,i;if(e=this,r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i=r.test(e),!i)return!1;for(t=e.split("."),n=0;4>n;){if(t[n]=parseInt(t[n],10),t[n]>255)return!1;n++}return!0},String.prototype.isEmail=function(){return/^[A-Z0-9._-]+@[A-Z0-9.-]+.[A-Z]{2,4}$/i.test(this)},String.prototype.isInteger=function(t){var n,e;return null==t&&(t=10),e=this,n=parseInt(e,t),!isNaN(n)&&""+n===e},String.prototype.isFloat=function(){var t,n,e;return n=e=this,t=parseFloat(n),isNaN(t)?!1:(e=""+t,e.indexOf(".")>-1?e=e.rpad(n.length,"0"):n.length>e.length&&(e+=".0",e=e.rpad(n.length,"0")),""+e==""+n)},s.namespace=function(t,n){var e,r,i,o,a;for(null==n&&(n=s.global||window),a=t.split("."),i=0,o=a.length;o>i;i++)r=a[i],e=n[r],e===void 0&&(e=n[r]={}),n=e;return n},s.tryThese=function(){var t,n,e;for(n=0,e=arguments.length;e>n;n++){t=arguments[n];try{return t()}catch(r){}}return!1},s.nestedValue=function(t,n){var e,r;return s.isNull(t)?null:s.isNull(n)?null:n.indexOf(".")>0?(r=n.before("."),t=s.nestedValue(t,r),n=n.after("."),s.nestedValue(t,n)):n.indexOf("[")>0?(r=n.before("["),e=n.between("[","]"),t=t[r],e=s.asInt(e),t[e]):t[n]},s.api={},n="api",e="["+n+"]",t="DEFAULT-API-KEY",$.fn.apiComponents=function(r){return this.each(function(){var i,o,a,u,l,p,c;if(a=$(this),o=a.attr(n),!o)return a.find(e).apiComponents();for(c=o.split(","),l=0,p=c.length;p>l;l++){if(r=c[l],r=$.trim(r).camelize().capitalize(),i=s.api[r],!i)throw Error("component is not available: "+r);if(!$.isFunction(i))throw Error("jetbrick.api."+r+" is not a Javascript Class");a.data(r)||(u=new i(a),a.data(r,u),a.data(t)||a.data(t,u))}}),null==r&&(r=t),this.data(r)},$(function(){return $(e).apiComponents()}),s.webroot=function(){var t;return s.webroot.cache?s.webroot.cache:(t=".",$("script[src*=jetbrick]").each(function(){var n;return n=this.src,n.endsWith(".js")?(t=n.beforeLast(n,"/"),!1):void 0}),t.endsWith("/js")&&(t=t.beforeLast("/js")),t.endsWith("/share")&&(t=t.beforeLast(t,"/share")),t.endsWith("/static")&&(t=t.beforeLast(t,"/static")),s.webroot.cache=t)},$.fn.effectiveToggle=function(t,n,e,r){var i;return null==t&&(t="default"),"default"===t?i=n:"fade"===t?("show"===n&&(i="fadeIn"),"hide"===n&&(i="fadeOut"),"toggle"===n&&(i="fadeToggle")):"slide"===t&&("show"===n&&(i="slideDown"),"hide"===n&&(i="slideUp"),"toggle"===n&&(i="slideToggle")),$.fn[i].call(this,e,r)},$.fn.outerHTML=function(){var t,n,e,r,i,o,s,a,u;if(0===this.length)return"";if(n=this[0],e=n.outerHTML)return e;for(i=n.tagName.toLowerCase(),e="<"+i,u=n.attributes,s=0,a=u.length;a>s;s++)t=u[s],r=t.nodeName,o=t.nodeValue,o&&(o=o.replace("'","\\'")),e+=" "+r+"='"+o+"'";return e+=">"+this.html()+"</"+i+">"},s.zIndex=function(){var t,n,e,r,i,o;for(e=document.getElementsByTagName("*"),t=0,i=0,o=e.length;o>i;i++)n=e[i],r=+n.style.zIndex||0,r>t&&(t=r);return t+1},s.addQueryString=function(t,n,e){return t+=0>t.indexOf("?")?"?":"&",t+=n+"="+s.asString(e)},s.redirectUrl=function(t,n){return t=s.addQueryString(t,"_",Math.random()),window.open(t,n||"_self",null,!0)},s.api.NumericInput=function(){function t(t,n){this.dom=t,this.options=$.extend({},this.dom.data(),n),this.dom.css("ime-mode","disabled"),this.dom.on("keypress",function(t){var n;return n=t.which,n>=48&&57>=n||46===n}),this.dom.on("blur",function(){return this.value.lastIndexOf(".")===this.value.length-1?this.value=this.value.substr(0,this.value.length-1):isNaN(this.value)?this.value="":void 0}),this.dom.on("paste",function(){var t;return t=clipboardData.getData("text"),/\D/.test(t)&&(this.value=t.replace(/^0*/,"")),!1}),this.dom.on("dragenter",function(){return!1}),this.dom.on("drop",function(){return!1}),this.dom.on("keyup",function(t){var n,e;return(e=t.which)>=35&&40>=e?!0:(n=this.value,n=n.replace(/[^\d.]/g,""),n=n.replace(/^\./g,""),n=n.replace(/\.{2,}/g,"."),n=n.replace(".","$#$").replace(/\./g,"").replace("$#$","."),this.value=n)})}return t}(),i=function(){function t(){this.dialogs=[],this.mask=$('<div class="js-lock" />').css({display:"none",position:"fixed",width:"100%",height:"100%",left:0,top:0,"background-color":"#000"}),$(document.body).append(this.mask)}return t.prototype.lock=function(t,n,e,r){return this.mask.css({opacity:n||.4,"z-index":t}),e?this.mask.fadeIn(e,r):this.mask.show()},t.prototype.unlock=function(){return this.mask.hide()},t.prototype.push=function(t){return this.dialogs.push({name:t,zIndex:s.zIndex()}),this.lock(item.zIndex)},t.prototype.pop=function(t){return this.dialogs=_.reject(this.dialogs,function(n){return n.name===t}),0===this.dialogs.length?this.unlock():this.lock(this.dialogs[this.dialogs.length-1].zIndex)},t}(),u=new i,r=function(){function t(){var t,n;n=s.webroot()+"/static/images/widget/ajax-loading.gif",t='<div class="js-ajax-loading">\n  <img src="'+n+'" style="vertical-align:middle" />\n  <span style="padding:0 12px">正在请求服务器，请稍后 ...</span>\n  <a href="javascript:;">(X)</a>\n</div>',this.loading=$(t).css({position:"fixed",dispaly:"block",width:"auto",left:"50%",top:"38%","font-size":"14px",border:"6px solid #555","background-color":"#fff",padding:"15px 20px","-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px","-webkit-box-shadow":"0 1px 10px rgba(0, 0, 0, 0.4)","-moz-box-shadow":"0 1px 10px rgba(0, 0, 0, 0.4)","box-shadow":"0 1px 10px rgba(0, 0, 0, 0.4)"}),$(document.body).append(this.loading),this.loading.find("a").on("click",$.proxy(this.hide,this))}return t.prototype.show=function(){return u.push("loadingSprite"),this.loading.css({"margin-left":0-this.$loading.outerWidth()/2,"margin-top":0-this.$loading.outerHeight()/2,"z-index":s.zIndex()}),this.loading.show()},t.prototype.hide=function(t){return this.loading.hide(),t?u.pop("loadingSprite"):void 0},t}(),a=new r,s.ajax=function(t,n,e,r,i){return a.show(),$.ajax({global:!1,cache:!1,async:!0,type:r||"GET",url:t,data:n,dataType:i||"json",success:function(){return a.hide(!1),e&&e.apply(this,arguments),a.hide(!0)},error:function(){return a.hide(!1),s.error("服务请求失败，请联系管理员或者稍后重试。"),a.hide(!0)}})},s.dialog=function(t,n,e){var r;return r=_.uniqueId("dialog_"),u.push(r),art.dialog({id:r,fixed:!0,lock:!1,title:t,content:n,zIndex:s.zIndex(),initialize:null!=e?e.initialize:void 0,ok:null!=e?e.ok:void 0,cancel:null!=e?e.cancel:void 0,beforeunload:function(){var t;return null!=e&&null!=(t=e.beforeunload)&&t.apply(this,arguments),u.pop(name)}})},l=function(t,n,e,r,i){return e='<span class="js-dialog-icon js-dialog-icon-'+t+'"></span>\n<span>'+e+"</span>",$.isFunction(r)&&(r=function(){return r.apply(this,arguments)}),$.isFunction(i)&&(i=function(){return i.apply(this,arguments)}),s.dialog(n,e,{ok:r,cancel:i})},s.info=function(t,n){return l("info","消息",t,n||!0)},s.warning=function(t,n){return l("warning","警告",t,n||!0)},s.error=function(t,n){return l("error","错误",t,n||!0)},s.confirm=function(t,n,e){return l("question","确认",t,n||!0,e||!0)},s.alert=function(t,n,e){return t?s.info(n,e):s.error(n,e)},s.prompt=function(t,n,e){return null==e&&(e=""),t=$('<div style="margin-bottom:5px;font-size:12px;">'+t+'</div>\n<div><input value="'+e+'" style="width:18em;padding:6px 4px;"></div>'),l("question","提问",t,function(){var e;return e=t.find("input"),null!=n?n.call(this,e.val()):void 0})}}).call(this);